<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Why STAGE? • stage</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Why STAGE?">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/why-stage.html">Why STAGE?</a></li>
    <li><a class="dropdown-item" href="../articles/likelihood.html">The STAGE Likelihood</a></li>
    <li><a class="dropdown-item" href="../articles/fit-stage.html">Fitting STAGE</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org">Stan</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/anhsmith/stage" aria-label="stage GitHub repository"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://seathrough.science" aria-label="Sea Through Science website"><span class="fa fa-globe"></span> Sea Through Science</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Why STAGE?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/anhsmith/stage/blob/master/vignettes/why-stage.Rmd" class="external-link"><code>vignettes/why-stage.Rmd</code></a></small>
      <div class="d-none name"><code>why-stage.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="problems-with-existing-methods">Problems with existing methods<a class="anchor" aria-label="anchor" href="#problems-with-existing-methods"></a>
</h3>
<p>Estimating a transition point—such as the length at which individuals
shift from immature to mature—is a simple and common task. However, the
statistical methods typically applied to this task are based on
inappropriate assumptions and likely produce biased estimates of
transition points.</p>
<p>Below, we discuss three current approaches, highlighting the
limitations of each.</p>
<div class="section level4">
<h4 id="ad-hoc-midpoint-methods">Ad hoc midpoint methods<a class="anchor" aria-label="anchor" href="#ad-hoc-midpoint-methods"></a>
</h4>
<p>A common approach is to avoid fitting a model altogether and instead
compute a transition point directly from the data. One such method is to
take the midpoint between the smallest mature and largest immature
individuals. The advantage of this approach is that it focuses on the
transition zone only. However, this approach (1) has no probabilistic
foundation and so cannot quantify uncertainty, and (2) uses only two
data points, so has high variance.</p>
</div>
<div class="section level4">
<h4 id="discriminative-models-e-g--logistic-regression">Discriminative models (e.g., logistic regression)<a class="anchor" aria-label="anchor" href="#discriminative-models-e-g--logistic-regression"></a>
</h4>
<p>Discriminative models such as logistic regression estimate the
conditional probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>∣</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(y = 1 \mid x)</annotation></semantics></math><em>directly</em>. In other words, the model focuses on predicting class
labels based on the prevalence of one class vs another at each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.</p>
<p>While simple and familiar, <em>logistic regression (and other
discriminative models) are highly sensitive to class imbalance</em>. The
discriminative model estimates the probability of class in the sample,
not the population.</p>
<p>Unless sampling is independent of both class and size, the estimated
curve can be seriously biased. If one class has a much greater sample
size than the other (i.e., they are unbalanced), logistic regression
effectively places more weight on the more abundant class. This pulls
the estimated transition curve toward the majority class, even though
class counts should not determine where the transition occurs.</p>
<p>An advantage of the discriminative-model approach (over other
methods) is that inferences about the transition point are based mainly
on data near the transition zone.</p>
</div>
<div class="section level4">
<h4 id="generative-models-e-g--linear-discriminant-analysis">Generative models (e.g., Linear Discriminant Analysis)<a class="anchor" aria-label="anchor" href="#generative-models-e-g--linear-discriminant-analysis"></a>
</h4>
<p>Generative models (often called generative classifiers) are an
alternative approach to discriminative models. They model the
class-conditional densities</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>∣</mo><mi>y</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="2.0em"></mspace><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>∣</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x \mid y = 0), \qquad f(x \mid y = 1)</annotation></semantics></math>,</p>
<p>and then obtain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>∣</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(y=1 \mid x)</annotation></semantics></math><em>via</em> Bayes’ rule.</p>
<p>The generative classifier approach has the advantage of being less
sensitive to class imbalance, since the transition point estimate
depends on the shapes of the class distributions, not their relative
sample sizes. This is achieved by fitting a density to each class
separately, and then calculating the transition point based on the
relative densities of the two classes. Linear Discriminant Analysis
(LDA) is a widely used generative classifier that fits a Gaussian
(Normal) density to each class.</p>
<p>This approach is less sensitive to class imbalance, they can suffer
from another important limitation: <em>estimates of transition points
from LDA (and other generative models) are potentially influenced by all
values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
not just those near the transition zone</em>.</p>
<p>Observations far from the transition zone greatly affect the fitted
density for that class, and therefore have undue influence on the
estimate of the transition point. For example, if the true transition is
around 1000 mm, individuals at 200–400 mm should not influence the
estimate of the maturity transition.</p>
<p>In LDA, the Gaussian tail behaviour near the transition is determined
by the estimated mean and variance of each class—and those estimates are
strongly affected by observations far from the transition. In the
context of length-at-maturity, this means that very small immature
individuals (e.g., neonates) and very large mature individuals have as
much influence on the transition point as individuals whose lengths fall
near the maturity boundary. This is unappealing, because these distant
observations contain almost no information about the location of the
transition, yet they shape the Gaussian fits and can shift the inferred
transition point substantially. This creates a further structural
problem: the two tails that actually matter for the transition—the upper
tail of the immature class and the lower tail of the mature class—are
not modelled directly against each other. Instead, each tail is
constrained to be the mirror image of the opposite tail of its own class
(because of the global Gaussian assumption).</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>What is needed is a model for estimating transition points that:</p>
<ul>
<li>is probabilistic and can quantify uncertainty,</li>
<li>robust to class imbalance, and</li>
<li>focuses inference on data in the overlap region rather than distant
data.</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="the-stage-solution">The STAGE solution<a class="anchor" aria-label="anchor" href="#the-stage-solution"></a>
</h2>
<p>The STAGE model is a Bayesian generative classifier where each class
is fit with an <strong>asymmetric Uniform–Gaussian mixture</strong>.</p>
<ul>
<li>
<strong>Immature (y = 0):</strong><br>
uniform plateau → Gaussian decay approaching the transition.</li>
<li>
<strong>Mature (y = 1):</strong><br>
Gaussian rise out of the transition → uniform plateau.</li>
</ul>
<p>This design has several key consequences:</p>
<div class="section level4">
<h4 id="generative-modelling">Generative modelling<a class="anchor" aria-label="anchor" href="#generative-modelling"></a>
</h4>
<p>Transition probability arises from comparing <strong>relative
densities</strong><br>
(Bayes rule), not from discriminative regression.</p>
</div>
<div class="section level4">
<h4 id="irrelevant-regions-contribute-minimally">Irrelevant regions contribute minimally<a class="anchor" aria-label="anchor" href="#irrelevant-regions-contribute-minimally"></a>
</h4>
<p>Observations far from the transition zone enter via the
<strong>uniform</strong> component,<br>
so they cannot distort estimates of the transition point.</p>
</div>
<div class="section level4">
<h4 id="robust-to-imbalance">Robust to imbalance<a class="anchor" aria-label="anchor" href="#robust-to-imbalance"></a>
</h4>
<p>Because inference depends on the <strong>shape</strong> of the
densities—not the counts—<br>
unbalanced datasets do not bias m50.</p>
</div>
<div class="section level4">
<h4 id="bayesian-inference">Bayesian inference<a class="anchor" aria-label="anchor" href="#bayesian-inference"></a>
</h4>
<p>Posterior uncertainty is natural, and multi-population structure
is<br>
handled with a hierarchical model.</p>
<p>The STAGE likelihood is a structured mixture inspired by the
plateau–Gaussian<br>
formulation of Lau &amp; Krumscheid <span class="citation">(2022)</span>, adapted for transition-point
estimation.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lau_plateau_2022" class="csl-entry">
Lau, F. Din-Houn, and Sebastian Krumscheid. 2022. <span>“Plateau
Proposal Distributions for Adaptive Component-Wise Multiple-Try
Metropolis.”</span> <em>METRON</em> 80 (3): 343–70. <a href="https://doi.org/10.1007/s40300-022-00235-y" class="external-link">https://doi.org/10.1007/s40300-022-00235-y</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam N. H. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
