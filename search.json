[{"path":"https://anhsmith.github.io/stage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Adam N. H. Smith Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://anhsmith.github.io/stage/articles/fit-stage.html","id":"simulating-data","dir":"Articles","previous_headings":"","what":"Simulating data","title":"Fitting the STAGE Model","text":"demonstrate workflow, simulate simple dataset lengths [L,U][L, U] smooth transition around true m50m_{50}.","code":"N <- 200 L <- 1000 U <- 1500 true_m50 <- 1250 true_d   <- 100  # Simulate covariate x <- runif(N, L, U)  # Smooth transition in P(mature) p <- plogis((x - true_m50) / (true_d / 4))  # Binary maturity indicator y <- rbinom(N, 1, p)  head(tibble(x = x, y = y)) #> # A tibble: 6 √ó 2 #>       x     y #>   <dbl> <int> #> 1 1133.     0 #> 2 1186.     0 #> 3 1286.     1 #> 4 1454.     1 #> 5 1101.     0 #> 6 1449.     1"},{"path":"https://anhsmith.github.io/stage/articles/fit-stage.html","id":"fitting-the-stage-model","dir":"Articles","previous_headings":"","what":"Fitting the STAGE model","title":"Fitting the STAGE Model","text":"now fit STAGE model using fit_stage(). STAGE Bayesian model fit via Stan, keep chains iter small vignette keep runtime acceptable; real applications increase . can inspect posterior standard tools summary(fit$fit), bayesplot, posterior utilities want diagnostics.","code":"fit <- fit_stage(x, y, L = L, U = U, chains = 2, iter = 1000) fit"},{"path":"https://anhsmith.github.io/stage/articles/fit-stage.html","id":"extracting-the-transition-point","dir":"Articles","previous_headings":"Fitting the STAGE model","what":"Extracting the transition point","title":"Fitting the STAGE Model","text":"helper transition_point() returns posterior summaries global transition point m50m_{50}. Typical output small data frame posterior mean, median, credible intervals m50.","code":"transition_point(fit)"},{"path":"https://anhsmith.github.io/stage/articles/fit-stage.html","id":"predicting-maturity-probabilities","dir":"Articles","previous_headings":"Fitting the STAGE model","what":"Predicting maturity probabilities","title":"Fitting the STAGE Model","text":"can also predict Pr(mature‚à£x)\\Pr(\\text{mature} \\mid x) grid lengths, plot posterior mean transition curve.","code":"x_grid <- seq(L, U, length.out = 200)  p_hat <- predict(fit, x_grid, type = \"prob\")  plot(   x_grid, p_hat, type = \"l\",   xlab = \"Length (x)\",   ylab = \"P(mature)\",   las = 1 )"},{"path":"https://anhsmith.github.io/stage/articles/fit-stage.html","id":"hierarchical-multi-population-model","dir":"Articles","previous_headings":"","what":"Hierarchical (multi-population) model","title":"Fitting the STAGE Model","text":"many applications multiple populations (e.g.¬†regions, stocks, sexes) expect: shared average transition point Œºm50\\mu_{m50}, population-specific deviations. STAGE implements using hierarchical structure m50pop[j]=Œºm50+zjœÉŒ±, m50_{\\text{pop}[j]} = \\mu_{m50} + z_j \\,\\sigma_\\alpha,  non-centred parameterisation efficient sampling. simple two-group example: transition_point(fit2) returns : global m50 (overall mean transition) group-specific m50_pop[j] values.","code":"group <- rep(c(\"A\", \"B\"), each = N/2)  fit2 <- fit_stage(   x, y,   group = group,   L = L, U = U,   chains = 2, iter = 1000 )  transition_point(fit2)"},{"path":"https://anhsmith.github.io/stage/articles/fit-stage.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Fitting the STAGE Model","text":"vignette : introduced plateau‚ÄìGaussian likelihood underlying STAGE, visualised class densities resulting transition probabilities, simulated simple dataset, fit STAGE model estimate transition point, extended model hierarchical multi-population setting. practice, want : choose [L,U][L, U] capture transition zone plus plateau side, check posterior diagnostics (divergences, R-hat, effective sample sizes), interpret m50m_{50} uncertainty biological context. Future vignettes expand : comparing STAGE logistic regression Gaussian LDA, sensitivity choice [L,U][L, U] prior settings.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"The STAGE Likelihood","text":"vignette describes likelihood parameterisation used STAGE model. STAGE hierarchical Bayesian generative model designed estimate transition point m50m_{50} variable xx two classes‚Äîexample, length individuals transition immature mature. model produces posterior distribution key parameter m50m_{50}, representing value xx probabilities Pr(y=0)\\Pr(y=0) Pr(y=1)\\Pr(y=1) equal. model can also used derive useful quantities (class probabilities Pr(y=1‚à£x)\\Pr(y = 1 \\mid x)). Conceptually, STAGE Bayesian generative classifier estimating transition point (e.g.¬†length maturity). class fit asymmetric plateau‚ÄìGaussian density: lower class uniform plateau followed Gaussian tail transition, higher class Gaussian tail transition followed uniform plateau.  construction focuses inference overlap region prevents distant observations (e.g.¬†small immatures, large matures) unduly influencing transition point. central idea model class piecewise density combines uniform plateau regions far transition, Gaussian tail transition region. left group (y=0y = 0) modelled uniform left begins lower truncation value LL. distribution remains flat approaches transition range, point distribution declines according Gaussian. right group (y=1y = 1) mirror image left‚Äîincreases according Gaussian distribution levels uniform, terminating upper truncation value UU. model focuses inference transition zone, values xx two classes overlap, -weights observations biologically uninformative far away transition point. uniform‚ÄìGaussian pdf used adapted plateau proposal distribution combining uniform two Gaussians described Lau & Krumscheid (2022).","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"model-summary","dir":"Articles","previous_headings":"","what":"Model summary","title":"The STAGE Likelihood","text":"observe pairs (xi,yi)(x_i, y_i) =1,‚Ä¶,Ni = 1, \\dots, N, xix_i continuous covariate (e.g., length), truncated interval [L,U][L, U], yi‚àà{0,1}y_i \\\\{0, 1\\} binary indicator state (e.g., immature / mature). model assumes distribution xx conditional state piecewise: y=0y = 0 (immature individuals), distribution xx approximately uniform point Œº0\\mu_0, follows Gaussian decay. y=1y = 1 (mature individuals), distribution Gaussian point Œº1\\mu_1, uniform Œº1\\mu_1 upper truncation UU. transition point m50m_{50} defined value xx probability observing either class equal: Pr(y=0‚à£x=m50)=Pr(y=1‚à£x=m50). \\Pr(y = 0 \\mid x = m_{50}) = \\Pr(y = 1 \\mid x = m_{50}). Additional parameters govern width sharpness transition: dd controls distance Œº0\\mu_0 Œº1\\mu_1 (width transition region), œÉ\\sigma (denoted sigma_x Stan code) controls spread (standard deviation) Gaussian tails. allowing different behaviours either side m50m_{50}, model can capture asymmetric transition patterns: immature class can decline towards transition different rate mature class rises . particularly useful settings : boundary classes sharp, data exhibit gradual overlap two classes.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"likelihood","dir":"Articles","previous_headings":"","what":"Likelihood","title":"The STAGE Likelihood","text":"likelihood built two unnormalised log-density functions two classes. work log scale numerical stability subtract log-normalising constants obtain valid densities. Let ‚Ñì0(x)\\ell_0(x) ‚Ñì1(x)\\ell_1(x) denote unnormalised log-densities y=0y = 0 y=1y = 1, respectively. corresponding (unnormalised) densities fÃÉk(x)=exp{‚Ñìk(x)}\\tilde f_k(x) = \\exp\\{\\ell_k(x)\\}. restrict attention truncated interval [L,U][L, U]; densities zero outside range.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"lower-class-y-0","dir":"Articles","previous_headings":"Likelihood","what":"Lower class (y=0y = 0)","title":"The STAGE Likelihood","text":"yi=0y_i = 0, unnormalised piecewise log-density ‚Ñì0(xi‚à£Œº0,œÉ,L)={0if L‚â§xi‚â§Œº0,‚àí(xi‚àíŒº0)22œÉ2if xi>Œº0. \\ell_0(x_i \\mid \\mu_0, \\sigma, L) = \\begin{cases} 0 & \\text{} L \\leq x_i \\leq \\mu_0, \\\\ -\\dfrac{(x_i - \\mu_0)^2}{2\\sigma^2} & \\text{} x_i > \\mu_0 . \\end{cases} : plateau region [L,Œº0][L, \\mu_0] constant log-density 0 (density 1), tail region xi>Œº0x_i > \\mu_0 decays according Gaussian kernel. constant added ‚Ñì0(‚ãÖ)\\ell_0(\\cdot) without changing posterior; fix plateau 0 plateau density 1 exponentiation.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"higher-class-y-1","dir":"Articles","previous_headings":"Likelihood","what":"Higher class (y=1y = 1)","title":"The STAGE Likelihood","text":"yi=1y_i = 1, unnormalised log-density ‚Ñì1(xi‚à£Œº1,œÉ,U)={‚àí(xi‚àíŒº1)22œÉ2if xi<Œº1,0if Œº1‚â§xi‚â§U. \\ell_1(x_i \\mid \\mu_1, \\sigma, U) = \\begin{cases} -\\dfrac{(x_i - \\mu_1)^2}{2\\sigma^2} & \\text{} x_i < \\mu_1, \\\\ 0 & \\text{} \\mu_1 \\leq x_i \\leq U . \\end{cases} Now: Gaussian tail Œº1\\mu_1, plateau covers upper region [Œº1,U][\\mu_1, U]. cases plateau‚ÄìGaussian shape: flat density class ‚Äúdominates‚Äù Gaussian tail transition region class present.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"normalisation-constants","dir":"Articles","previous_headings":"Likelihood","what":"Normalisation constants","title":"The STAGE Likelihood","text":"convert fÃÉk(x)=exp{‚Ñìk(x)}\\tilde f_k(x) = \\exp\\{\\ell_k(x)\\} proper probability density functions [L,U][L, U], divide constants C0C_0 C1C_1 chosen densities integrate 1. immature class (y=0y = 0): C0=‚à´LŒº01dx+‚à´Œº0‚àû12œÄœÉexp(‚àí(x‚àíŒº0)22œÉ2)dx=(Œº0‚àíL)+2œÄœÉ2. C_0 = \\int_L^{\\mu_0} 1 \\, dx   + \\int_{\\mu_0}^{\\infty}     \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\!\\left(       -\\frac{(x - \\mu_0)^2}{2\\sigma^2}     \\right) dx = (\\mu_0 - L) + \\frac{\\sqrt{2\\pi}\\,\\sigma}{2}. mature class (y=1y = 1): C1=‚à´‚àí‚àûŒº112œÄœÉexp(‚àí(x‚àíŒº1)22œÉ2)dx+‚à´Œº1U1dx=2œÄœÉ2+(U‚àíŒº1). C_1 = \\int_{-\\infty}^{\\mu_1}     \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\!\\left(       -\\frac{(x - \\mu_1)^2}{2\\sigma^2}     \\right) dx   + \\int_{\\mu_1}^{U} 1 \\, dx = \\frac{\\sqrt{2\\pi}\\,\\sigma}{2} + (U - \\mu_1). Intuitively: (Œº0‚àíL)(\\mu_0 - L) (U‚àíŒº1)(U - \\mu_1) widths uniform plateaus, 2œÄœÉ/2\\sqrt{2\\pi}\\,\\sigma / 2 contribution half-Gaussian tail. corresponding log-likelihood contribution observation ii log‚Ñíi={‚Ñì0(xi)‚àílogC0if yi=0,‚Ñì1(xi)‚àílogC1if yi=1. \\log \\mathcal{L}_i = \\begin{cases} \\ell_0(x_i) - \\log C_0 & \\text{} y_i = 0, \\\\ \\ell_1(x_i) - \\log C_1 & \\text{} y_i = 1. \\end{cases} Summing observations, logp(x,y‚à£m50,d,œÉ)=‚àë=1N[‚Ñìyi(xi)‚àílogCyi], \\log p(x, y \\mid m_{50}, d, \\sigma) = \\sum_{=1}^{N} \\big[   \\ell_{y_i}(x_i) - \\log C_{y_i} \\big], exactly likelihood implemented Stan code used fit_stage().","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"prior-specification","dir":"Articles","previous_headings":"","what":"Prior specification","title":"The STAGE Likelihood","text":"priors reflect prior beliefs plausible transition points transition widths typical length--maturity problems. practice, defaults adapted scale data prior biological knowledge. default, STAGE uses weakly informative normal priors: Transition point m50m_{50}: m50‚àºùí©(1300,50), m_{50} \\sim \\mathcal{N}(1300, 50), centres transition around 1300 (mm) moderate uncertainty. Transition width dd: d‚àºùí©(100,100), d \\sim \\mathcal{N}(100, 100), allows width overlap region vary around 100 units wide spread. Note dd distance class-specific Gaussian centres. Gaussian spread œÉ\\sigma (Stan parameter sigma_x): œÉ‚àºùí©(100,50), \\sigma \\sim \\mathcal{N}(100, 50), representing prior beliefs scale variability transition tails. practice, adapt priors scale (e.g., lengths, ages) prior biological knowledge. STAGE implementation allows pass hyperparameters via helper functions stage_priors().","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"transformed-parameters","dir":"Articles","previous_headings":"","what":"Transformed parameters","title":"The STAGE Likelihood","text":"Gaussian ‚Äúcentres‚Äù two classes defined terms transition point m50m_{50} width parameter dd: Œº0=m50‚àíd2,Œº1=m50+d2. \\mu_0 = m_{50} - \\frac{d}{2}, \\qquad \\mu_1 = m_{50} + \\frac{d}{2}. Thus: dd controls distance immature mature Gaussian means, m50m_{50} remains midpoint . convenient conceptually computationally: allows model focus directly m50m_{50} dd, often primary scientific targets, Œº0\\mu_0 Œº1\\mu_1 derived quantities.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"from-class-densities-to-class-probabilities-bayes-rule","dir":"Articles","previous_headings":"","what":"From class densities to class probabilities (Bayes rule)","title":"The STAGE Likelihood","text":"likelihood defines class-conditional densitiesf0(x)=p(x‚à£y=0)f_0(x) = p(x \\mid y = 0) f1(x)=p(x‚à£y=1)f_1(x) = p(x \\mid y = 1) [L,U][L, U], obtained normalising unnormalised densities fÃÉk(x)=exp{‚Ñìk(x)}\\tilde f_k(x) = \\exp\\{\\ell_k(x)\\} constants CkC_k. obtain probability individual particular xx value higher class (y=1y = 1), use Bayes rule: Pr(y=1‚à£x)=œÄ1f1(x)œÄ0f0(x)+œÄ1f1(x), \\Pr(y = 1 \\mid x) = \\frac{\\pi_1 f_1(x)}{\\pi_0 f_0(x) + \\pi_1 f_1(x)}, similarly Pr(y=0‚à£x)=œÄ0f0(x)œÄ0f0(x)+œÄ1f1(x), \\Pr(y = 0 \\mid x) = \\frac{\\pi_0 f_0(x)}{\\pi_0 f_0(x) + \\pi_1 f_1(x)}, œÄ0\\pi_0 œÄ1\\pi_1 prior class probabilities (e.g., prior probabilities immature mature seeing xx). many applications, estimating length--maturity, interested transition point driven sample sizes prevalence, natural use equal class priors, œÄ0=œÄ1=1/2\\pi_0 = \\pi_1 = 1/2. case, Bayes rule simplifies Pr(y=1‚à£x)=f1(x)f0(x)+f1(x),Pr(y=0‚à£x)=f0(x)f0(x)+f1(x). \\Pr(y = 1 \\mid x) = \\frac{f_1(x)}{f_0(x) + f_1(x)}, \\qquad \\Pr(y = 0 \\mid x) = \\frac{f_0(x)}{f_0(x) + f_1(x)}. class probabilities STAGE model uses prediction, see plot Pr(y=1‚à£x)\\Pr(y = 1 \\mid x) function xx.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"connection-to-m_50","dir":"Articles","previous_headings":"From class densities to class probabilities (Bayes rule)","what":"Connection to m50m_{50}","title":"The STAGE Likelihood","text":"definition, transition point m50m_{50} value xx two classes equally probable: Pr(y=0‚à£x=m50)=Pr(y=1‚à£x=m50)=12. \\Pr(y = 0 \\mid x = m_{50}) = \\Pr(y = 1 \\mid x = m_{50}) = \\frac{1}{2}. Using Bayes rule equal class priors, equality equivalent f1(m50)f0(m50)+f1(m50)=f0(m50)f0(m50)+f1(m50)‚áîf0(m50)=f1(m50). \\frac{f_1(m_{50})}{f_0(m_{50}) + f_1(m_{50})} = \\frac{f_0(m_{50})}{f_0(m_{50}) + f_1(m_{50})} \\quad\\Longleftrightarrow\\quad f_0(m_{50}) = f_1(m_{50}). Thus, m50m_{50} can viewed two equivalent ways: model parameter sets midpoint Gaussian centres Œº0\\mu_0 Œº1\\mu_1 viaŒº0=m50‚àíd2,Œº1=m50+d2, \\mu_0 = m_{50} - \\frac{d}{2}, \\qquad \\mu_1 = m_{50} + \\frac{d}{2}, Bayes-optimal classifier cut-point posterior class probabilities immature mature 0.5. practice, STAGE model samples m50m_{50}, dd, œÉ\\sigma posterior distribution. posterior draw, can compute Pr(y=1‚à£x)\\Pr(y = 1 \\mid x) via Bayes rule verify point curve crosses 0.5 aligns sampled value m50m_{50}. makes interpretation m50m_{50} ‚Äú50% maturity‚Äù transition point directly linked underlying generative model Bayes-optimal classifier.","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"visualising-a-single-stage-transition","dir":"Articles","previous_headings":"From class densities to class probabilities (Bayes rule)","what":"Visualising a single STAGE transition","title":"The STAGE Likelihood","text":"can visualise simple STAGE configuration, showing: immature mature densities, resulting transition probability Pr(y=1‚à£x)\\Pr(y=1 \\mid x).","code":""},{"path":"https://anhsmith.github.io/stage/articles/likelihood.html","id":"relationship-to-the-stage-implementation","dir":"Articles","previous_headings":"","what":"Relationship to the stage implementation","title":"The STAGE Likelihood","text":"stage package: single-population model uses parameters m50, d, sigma_x correspond m50m_{50}, dd, œÉ\\sigma vignette. multi-population (hierarchical) model introduces population-specific transition points m50,jm_{50, j} via random-effects structure: m50pop[j]=Œºm50+zjœÉŒ±, m50_{\\text{pop}[j]} = \\mu_{m50} + z_j \\, \\sigma_\\alpha,  Œºm50\\mu_{m50} overall mean transition point, zjz_j standard-normal effects, œÉŒ±\\sigma_\\alpha population-level standard deviation. Stan code used fit_stage() direct implementation likelihood parameterisation described . Future vignettes provide detailed walk-Stan code extensions alternative priors model comparison.","code":""},{"path":[]},{"path":[]},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"problems-with-existing-methods","dir":"Articles","previous_headings":"Introduction","what":"Problems with existing methods","title":"Why STAGE?","text":"Estimating transition point‚Äîlength individuals shift immature mature‚Äîsimple common task. However, statistical methods typically applied task based inappropriate assumptions likely produce biased estimates transition points. , discuss three current approaches, highlighting limitations .","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"ad-hoc-midpoint-methods","dir":"Articles","previous_headings":"Introduction > Problems with existing methods","what":"Ad hoc midpoint methods","title":"Why STAGE?","text":"common approach avoid fitting model altogether instead compute transition point directly data. One method take midpoint smallest mature largest immature individuals. advantage approach focuses transition zone . However, approach (1) probabilistic foundation quantify uncertainty, (2) uses two data points, high variance.","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"discriminative-models-e-g--logistic-regression","dir":"Articles","previous_headings":"Introduction > Problems with existing methods","what":"Discriminative models (e.g., logistic regression)","title":"Why STAGE?","text":"Discriminative models logistic regression estimate conditional probability P(y=1‚à£x)P(y = 1 \\mid x)directly. words, model focuses predicting class labels based prevalence one class vs another value xx. simple familiar, logistic regression (discriminative models) highly sensitive class imbalance. discriminative model estimates probability class sample, population. Unless sampling independent class size, estimated curve can seriously biased. one class much greater sample size (.e., unbalanced), logistic regression effectively places weight abundant class. pulls estimated transition curve toward majority class, even though class counts determine transition occurs. advantage discriminative-model approach (methods) inferences transition point based mainly data near transition zone.","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"generative-models-e-g--linear-discriminant-analysis","dir":"Articles","previous_headings":"Introduction > Problems with existing methods","what":"Generative models (e.g., Linear Discriminant Analysis)","title":"Why STAGE?","text":"Generative models (often called generative classifiers) alternative approach discriminative models. model class-conditional densities f(x‚à£y=0),f(x‚à£y=1)f(x \\mid y = 0), \\qquad f(x \\mid y = 1), obtain P(y=1‚à£x)P(y=1 \\mid x)via Bayes‚Äô rule. generative classifier approach advantage less sensitive class imbalance, since transition point estimate depends shapes class distributions, relative sample sizes. achieved fitting density class separately, calculating transition point based relative densities two classes. Linear Discriminant Analysis (LDA) widely used generative classifier fits Gaussian (Normal) density class. approach less sensitive class imbalance, can suffer another important limitation: estimates transition points LDA (generative models) potentially influenced values xx, just near transition zone. Observations far transition zone greatly affect fitted density class, therefore undue influence estimate transition point. example, true transition around 1000 mm, individuals 200‚Äì400 mm influence estimate maturity transition. LDA, Gaussian tail behaviour near transition determined estimated mean variance class‚Äîestimates strongly affected observations far transition. context length--maturity, means small immature individuals (e.g., neonates) large mature individuals much influence transition point individuals whose lengths fall near maturity boundary. unappealing, distant observations contain almost information location transition, yet shape Gaussian fits can shift inferred transition point substantially. creates structural problem: two tails actually matter transition‚Äîupper tail immature class lower tail mature class‚Äîmodelled directly . Instead, tail constrained mirror image opposite tail class (global Gaussian assumption).","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"summary","dir":"Articles","previous_headings":"Introduction","what":"Summary","title":"Why STAGE?","text":"needed model estimating transition points : probabilistic can quantify uncertainty, robust class imbalance, focuses inference data overlap region rather distant data.","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"the-stage-solution","dir":"Articles","previous_headings":"","what":"The STAGE solution","title":"Why STAGE?","text":"STAGE model Bayesian generative classifier class fit asymmetric Uniform‚ÄìGaussian mixture. Immature (y = 0): uniform plateau ‚Üí Gaussian decay approaching transition. Mature (y = 1): Gaussian rise transition ‚Üí uniform plateau. design several key consequences:","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"generative-modelling","dir":"Articles","previous_headings":"The STAGE solution","what":"Generative modelling","title":"Why STAGE?","text":"Transition probability arises comparing relative densities (Bayes rule), discriminative regression.","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"irrelevant-regions-contribute-minimally","dir":"Articles","previous_headings":"The STAGE solution","what":"Irrelevant regions contribute minimally","title":"Why STAGE?","text":"Observations far transition zone enter via uniform component, distort estimates transition point.","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"robust-to-imbalance","dir":"Articles","previous_headings":"The STAGE solution","what":"Robust to imbalance","title":"Why STAGE?","text":"inference depends shape densities‚Äîcounts‚Äî unbalanced datasets bias m50.","code":""},{"path":"https://anhsmith.github.io/stage/articles/why-stage.html","id":"bayesian-inference","dir":"Articles","previous_headings":"The STAGE solution","what":"Bayesian inference","title":"Why STAGE?","text":"Posterior uncertainty natural, multi-population structure handled hierarchical model. STAGE likelihood structured mixture inspired plateau‚ÄìGaussian formulation Lau & Krumscheid (2022), adapted transition-point estimation.","code":""},{"path":[]},{"path":"https://anhsmith.github.io/stage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Adam N. H. Smith. Author, maintainer.","code":""},{"path":"https://anhsmith.github.io/stage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Smith, . (2025). *STAGE: State Transition Analysis via Generative Estimator.* R package version 0.1.0. Available : https://github.com/anhsmith/stage.","code":"@Manual{,   title = {STAGE: State Transition Analysis via Generative Estimator},   author = {Adam N. H. Smith},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/anhsmith/stage}, }"},{"path":"https://anhsmith.github.io/stage/index.html","id":"id_-stage-","dir":"","previous_headings":"","what":"Models for Estimating Stage-Transition Points","title":"Models for Estimating Stage-Transition Points","text":"stage package implements STAGE model (State Transition Analysis via Generative Estimator), Bayesian generative classifier estimating transition points (m50) two groups‚Äîvalue xx y=1y=1 become probable. example length--maturity problems, yy binary maturity status, xx continuous measurement, length. Existing methods sorts applications important limitations (see ), STAGE model overcomes. Features STAGE model : class fit mixture distribution combines uniform plateau Gaussian tail Estimation transition point (m50) based relative densities (Bayes‚Äô rule) classes given xx, discriminative regression shared transition region centred m50 width d. goal model transition-point estimation focuses inference data around transition point robust unbalanced sample sizes.  process testing STAGE model methods underway.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"package-features","dir":"","previous_headings":"","what":"Package features","title":"Models for Estimating Stage-Transition Points","text":"fit_stage() ‚Äî fit STAGE model (single multi-population) transition_point() ‚Äî summarise posteriors m50 predict.stage_fit() ‚Äî predict class probabilities labels stage_priors() ‚Äî prior helper get_cmdstan_model() ‚Äî internal CmdStan compiler helper Planned additions: Reparameterised logistic/HOF model Bayesian LDA Posterior predictive classification Diagnostic + visualisation tools Full vignette","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Models for Estimating Stage-Transition Points","text":"need cmdstanr + CmdStan installed: install GitHub:","code":"install.packages(\"cmdstanr\",   repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")) ) cmdstanr::install_cmdstan()   # run once devtools::install_github(\"anhsmith/stage\")"},{"path":"https://anhsmith.github.io/stage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Models for Estimating Stage-Transition Points","text":"Estimated transition point: Prediction:","code":"library(stage)  set.seed(123)  N <- 200 L <- 1000 U <- 1500 true_m50 <- 1250 true_d   <- 100  # simulate data x <- runif(N, L, U) p <- plogis((x - true_m50) / (true_d / 4)) y <- rbinom(N, 1, p)  # fit STAGE model fit <- fit_stage(x, y, L = L, U = U, chains = 2, iter = 1000) fit transition_point(fit) x_grid <- seq(L, U, length.out = 100) p_hat <- predict(fit, x_grid, type = \"prob\")  plot(x_grid, p_hat, type = \"l\",      xlab = \"x\", ylab = \"P(mature)\", las = 1)"},{"path":"https://anhsmith.github.io/stage/index.html","id":"hierarchical-model","dir":"","previous_headings":"","what":"Hierarchical model","title":"Models for Estimating Stage-Transition Points","text":"Multiple populations: returns: global m50 group-specific m50_pop[j]","code":"group <- rep(c(\"A\",\"B\"), each = N/2)  fit2 <- fit_stage(x, y, group = group, L = L, U = U)  transition_point(fit2)"},{"path":"https://anhsmith.github.io/stage/index.html","id":"model-summary","dir":"","previous_headings":"","what":"Model summary","title":"Models for Estimating Stage-Transition Points","text":"class uniform plateau Gaussian edge. Key parameters: m50 ‚Äî transition centre d ‚Äî width transition region sigma_x ‚Äî Gaussian spread Hierarchical structure: (non-centred parameterisation efficient sampling)","code":"m50_pop[j] = mu_m50 + z[j] * sigma_alpha"},{"path":"https://anhsmith.github.io/stage/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"Models for Estimating Stage-Transition Points","text":"","code":"devtools::test() devtools::document() devtools::build_readme()"},{"path":"https://anhsmith.github.io/stage/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Models for Estimating Stage-Transition Points","text":"MIT ¬© Adam N. H. Smith","code":""},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit the STAGE (uniform + Gaussian) generative model ‚Äî fit_stage","title":"Fit the STAGE (uniform + Gaussian) generative model ‚Äî fit_stage","text":"Fit STAGE (uniform + Gaussian) generative model","code":""},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit the STAGE (uniform + Gaussian) generative model ‚Äî fit_stage","text":"","code":"fit_stage(   x,   y,   group = NULL,   L = NULL,   U = NULL,   priors = stage_priors(x, y),   chains = 4,   iter = 2000,   ... )"},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit the STAGE (uniform + Gaussian) generative model ‚Äî fit_stage","text":"x Numeric vector predictor values (e.g. length). y Binary vector: 0 = immature, 1 = mature. group Optional grouping variable (population). NULL, data treated one population (J = 1). L, U Truncation bounds x. NULL, use min(x) max(x). priors list prior hyperparameters created stage_priors(). chains, iter, ... Passed cmdstanr::sample().","code":""},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit the STAGE (uniform + Gaussian) generative model ‚Äî fit_stage","text":"object class \"stage_fit\".","code":""},{"path":"https://anhsmith.github.io/stage/reference/get_cmdstan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Get compiled cmdstanr model ‚Äî get_cmdstan_model","title":"Get compiled cmdstanr model ‚Äî get_cmdstan_model","text":"Get compiled cmdstanr model Get compiled cmdstanr model inst/stan","code":""},{"path":"https://anhsmith.github.io/stage/reference/get_cmdstan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get compiled cmdstanr model ‚Äî get_cmdstan_model","text":"","code":"get_cmdstan_model(stan_file)  get_cmdstan_model(stan_file)"},{"path":"https://anhsmith.github.io/stage/reference/plateau_gaussian_density_left.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes the normalised plateau‚ÄìGaussian density used for y = 0 ‚Äî plateau_gaussian_density_left","title":"Computes the normalised plateau‚ÄìGaussian density used for y = 0 ‚Äî plateau_gaussian_density_left","text":"Computes normalised plateau‚ÄìGaussian density used y = 0","code":""},{"path":"https://anhsmith.github.io/stage/reference/plateau_gaussian_density_left.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes the normalised plateau‚ÄìGaussian density used for y = 0 ‚Äî plateau_gaussian_density_left","text":"","code":"plateau_gaussian_density_left(x, mu, sigma, L)"},{"path":"https://anhsmith.github.io/stage/reference/plateau_gaussian_density_left.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes the normalised plateau‚ÄìGaussian density used for y = 0 ‚Äî plateau_gaussian_density_left","text":"x vector x-values mu mean location Gaussian tail sigma transition spread L lower truncation","code":""},{"path":"https://anhsmith.github.io/stage/reference/plateau_gaussian_density_right.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes the normalised plateau‚ÄìGaussian density used for y = 1 ‚Äî plateau_gaussian_density_right","title":"Computes the normalised plateau‚ÄìGaussian density used for y = 1 ‚Äî plateau_gaussian_density_right","text":"Computes normalised plateau‚ÄìGaussian density used y = 1","code":""},{"path":"https://anhsmith.github.io/stage/reference/plateau_gaussian_density_right.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes the normalised plateau‚ÄìGaussian density used for y = 1 ‚Äî plateau_gaussian_density_right","text":"","code":"plateau_gaussian_density_right(x, mu, sigma, U)"},{"path":"https://anhsmith.github.io/stage/reference/plateau_gaussian_density_right.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes the normalised plateau‚ÄìGaussian density used for y = 1 ‚Äî plateau_gaussian_density_right","text":"x vector x-values mu mean Gaussian tail sigma transition spread U upper truncation","code":""},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict class probabilities from a STAGE model ‚Äî predict.stage_fit","title":"Predict class probabilities from a STAGE model ‚Äî predict.stage_fit","text":"Predict class probabilities STAGE model","code":""},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict class probabilities from a STAGE model ‚Äî predict.stage_fit","text":"","code":"# S3 method for class 'stage_fit' predict(object, newdata, group = NULL, type = c(\"prob\", \"class\"), ...)"},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict class probabilities from a STAGE model ‚Äî predict.stage_fit","text":"object stage_fit object returned fit_stage(). newdata Numeric vector new x values. group Optional group new x (length 1 length(newdata)). NULL multiple populations model, population 1 used predictions. type \"prob\" P(y = 1 | x), \"class\" 0/1 classification. ... Currently ignored.","code":""},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict class probabilities from a STAGE model ‚Äî predict.stage_fit","text":"Numeric vector probabilities classes.","code":""},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct prior hyperparameters for the STAGE model ‚Äî stage_priors","title":"Construct prior hyperparameters for the STAGE model ‚Äî stage_priors","text":"Construct prior hyperparameters STAGE model","code":""},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct prior hyperparameters for the STAGE model ‚Äî stage_priors","text":"","code":"stage_priors(   x = NULL,   y = NULL,   prior_mu_m50_mu = if (!is.null(x)) stats::median(x) else 0,   prior_mu_m50_tau = if (!is.null(x)) diff(range(x))/6 else 100,   prior_d_mu = if (!is.null(x)) diff(range(x))/4 else 0,   prior_d_tau = if (!is.null(x)) diff(range(x))/4 else 100,   prior_sigma_x_tau = if (!is.null(x)) stats::sd(x) else 100,   prior_sigma_alpha_tau = if (!is.null(x)) diff(range(x))/6 else 100 )"},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct prior hyperparameters for the STAGE model ‚Äî stage_priors","text":"x, y Optional data vectors set sensible defaults. prior_mu_m50_mu Mean prior global m50. prior_mu_m50_tau SD prior global m50. prior_d_mu Mean prior d. prior_d_tau SD prior d. prior_sigma_x_tau SD scale sigma_x. prior_sigma_alpha_tau SD scale sigma_alpha (-pop).","code":""},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct prior hyperparameters for the STAGE model ‚Äî stage_priors","text":"list elements matching Stan data block.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic transition point extractor ‚Äî transition_point","title":"Generic transition point extractor ‚Äî transition_point","text":"Generic transition point extractor","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic transition point extractor ‚Äî transition_point","text":"","code":"transition_point(object, ...)"},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic transition point extractor ‚Äî transition_point","text":"object model fit object. ... arguments passed methods.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic transition point extractor ‚Äî transition_point","text":"Typically numeric vector list summarising transition point.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior summaries of STAGE transition points (m50) ‚Äî transition_point.stage_fit","title":"Posterior summaries of STAGE transition points (m50) ‚Äî transition_point.stage_fit","text":"Posterior summaries STAGE transition points (m50)","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior summaries of STAGE transition points (m50) ‚Äî transition_point.stage_fit","text":"","code":"# S3 method for class 'stage_fit' transition_point(object, population = NULL, ...)"},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior summaries of STAGE transition points (m50) ‚Äî transition_point.stage_fit","text":"object stage_fit object returned fit_stage(). population Optional population index (integer) label (character). NULL, return global populations. ... Currently ignored. Included method compatibility.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior summaries of STAGE transition points (m50) ‚Äî transition_point.stage_fit","text":"named list numeric vector posterior summary stats.","code":""}]
