[{"path":"https://anhsmith.github.io/stage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Adam N. H. Smith Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://anhsmith.github.io/stage/articles/stage-intro.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to the STAGE Model","text":"STAGE model (State Transition Analysis via Generative Estimation) Bayesian generative classifier designed estimate maturity transition points class distribution : uniform (plateau) region, Gaussian tail, transition point m50, width d. STAGE can fit single population hierarchically multiple populations.","code":""},{"path":"https://anhsmith.github.io/stage/articles/stage-intro.html","id":"fitting-the-model","dir":"Articles","previous_headings":"","what":"Fitting the model","title":"Introduction to the STAGE Model","text":"simulate simple dataset: Fit STAGE model:","code":"N <- 200 L <- 1000 U <- 1500 true_m50 <- 1250 true_d   <- 100  x <- runif(N, L, U) p <- plogis((x - true_m50) / (true_d/4)) y <- rbinom(N, 1, p) fit <- fit_stage(x, y, L = L, U = U, chains = 2, iter = 1000) fit"},{"path":"https://anhsmith.github.io/stage/articles/stage-intro.html","id":"extracting-the-transition-point","dir":"Articles","previous_headings":"","what":"Extracting the transition point","title":"Introduction to the STAGE Model","text":"returns posterior summary statistics global transition point (m50).","code":"transition_point(fit)"},{"path":"https://anhsmith.github.io/stage/articles/stage-intro.html","id":"prediction","dir":"Articles","previous_headings":"","what":"Prediction","title":"Introduction to the STAGE Model","text":"","code":"x_grid <- seq(L, U, length.out = 200) p_hat <- predict(fit, x_grid, type = \"prob\")  plot(   x_grid, p_hat, type = \"l\",   xlab = \"x\", ylab = \"P(mature)\", las = 1 )"},{"path":"https://anhsmith.github.io/stage/articles/stage-intro.html","id":"hierarchical-model-example","dir":"Articles","previous_headings":"","what":"Hierarchical model example","title":"Introduction to the STAGE Model","text":"yields : global m50 population-specific m50_pop[j].","code":"group <- rep(c(\"A\", \"B\"), each = N/2)  fit2 <- fit_stage(x, y, group = group, L = L, U = U, chains = 2, iter = 1000)  transition_point(fit2)"},{"path":"https://anhsmith.github.io/stage/articles/stage-intro.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Introduction to the STAGE Model","text":"vignette demonstrated: simulating data fitting STAGE model extracting posterior transition points predicting maturity probabilities running hierarchical model extensions (HOF model, Bayesian LDA, plotting utilities) added future versions stage.","code":""},{"path":"https://anhsmith.github.io/stage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Adam N. H. Smith. Author, maintainer.","code":""},{"path":"https://anhsmith.github.io/stage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Smith, . (2025). *STAGE: State Transition Analysis via Generative Estimator.* R package version 0.1.0. Available : https://github.com/anhsmith/stage.","code":"@Manual{,   title = {STAGE: State Transition Analysis via Generative Estimator},   author = {Adam N. H. Smith},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/anhsmith/stage}, }"},{"path":"https://anhsmith.github.io/stage/index.html","id":"id_-stage-","dir":"","previous_headings":"","what":"Models for Estimating Stage-Transition Points","title":"Models for Estimating Stage-Transition Points","text":"stage package implements STAGE model (State Transition Analysis via Generative Estimator), Bayesian generative classifier estimating transition points (e.g., length--maturity) two groups underlying distributions consist : uniform plateau, Gaussian tail, shared transition region centred m50 width d. goal robust transition-point estimation even highly unbalanced sample sizes data far transition zone.","code":""},{"path":[]},{"path":"https://anhsmith.github.io/stage/index.html","id":"problems-with-existing-methods","dir":"","previous_headings":"","what":"Problems with existing methods","title":"Models for Estimating Stage-Transition Points","text":"Estimating transition point—length individuals shift immature mature—simple common task, surprisingly difficult. Existing methods fail important ways.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"ad-hoc-midpoint-methods","dir":"","previous_headings":"Problems with existing methods","what":"Ad hoc midpoint methods","title":"Models for Estimating Stage-Transition Points","text":"common practice avoid fitting model altogether instead compute transition point directly data. widespread example midpoint smallest mature largest immature individuals. advantage approach focuses transition zone . However, approach (1) probabilistic foundation quantify uncertainty, (2) uses two data points, high variance.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"discriminative-models-eg-logistic-regression","dir":"","previous_headings":"Problems with existing methods","what":"Discriminative models (e.g., logistic regression)","title":"Models for Estimating Stage-Transition Points","text":"Discriminative models logistic regression estimate conditional probability P(y=1∣x)P(y = 1 \\mid x)directly. words, model focuses predicting class labels based prevalence one class vs another value xx. simple familiar, suffer two major issues setting: Sensitivity class imbalance. Logistic regression (discriminative models) estimates probability maturity sample, population. Unless sampling independent class size, estimated curve can seriously biased. one class much greater sample size (.e., unbalanced), logistic regression effectively places weight abundant class. pulls estimated transition curve toward majority class, even though class counts determine transition occurs. Influence biologically irrelevant regions. Observations far transition zone change fitted slope intercept—even though contain information transition takes place. example, true transition around 1000 mm, individuals 200–400 mm influence estimate maturity transition, discriminative model often . advantage discriminative-model approach inferences transition point based mainly data near transition zone.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"gaussian-generative-models-eg-linear-discriminant-analysis","dir":"","previous_headings":"Problems with existing methods","what":"Gaussian generative models (e.g., Linear Discriminant Analysis)","title":"Models for Estimating Stage-Transition Points","text":"Generative classifiers model class-conditional densities f(x∣y=0),f(x∣y=1)f(x \\mid y = 0), \\qquad f(x \\mid y = 1), obtain P(y=1∣x)P(y=1 \\mid x)via Bayes’ rule. generative classifier approach advantage less sensitive class imbalance, since transition point estimate depends shapes class distributions, relative sample sizes. achieved fitting density class separately, calculating transition point based relative densities two classes. Linear Discriminant Analysis (LDA) widely used generative classifier fits Gaussian (Normal) density class. However, generative models less sensitive class imbalance, suffer another important limitation: estimation transition point influenced values xx, just near transition zone. LDA, Gaussian tail behaviour near transition determined estimated mean variance class—estimates strongly affected observations far transition. context length--maturity, means small immature individuals (e.g., neonates) large mature individuals much influence transition point individuals whose lengths fall near maturity boundary. unappealing, distant observations contain almost information location transition, yet shape Gaussian fits can shift inferred transition point substantially. creates structural problem: two tails actually matter transition—upper tail immature class lower tail mature class—modelled directly . Instead, tail constrained mirror image opposite tail class (global Gaussian assumption).","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"summary","dir":"","previous_headings":"","what":"Summary","title":"Models for Estimating Stage-Transition Points","text":"needed model estimating transition points : probabilistic can quantify uncertainty, robust class imbalance, focuses inference data overlap region rather distant data.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"the-stage-solution","dir":"","previous_headings":"","what":"The STAGE solution","title":"Models for Estimating Stage-Transition Points","text":"STAGE model Bayesian generative classifier class fit asymmetric Uniform–Gaussian mixture. Immature (y = 0): uniform plateau → Gaussian decay approaching transition. Mature (y = 1): Gaussian rise transition → uniform plateau. design several key consequences:","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"generative-modelling","dir":"","previous_headings":"","what":"Generative modelling","title":"Models for Estimating Stage-Transition Points","text":"Transition probability arises comparing relative densities (Bayes rule), discriminative regression.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"irrelevant-regions-contribute-minimally","dir":"","previous_headings":"","what":"Irrelevant regions contribute minimally","title":"Models for Estimating Stage-Transition Points","text":"Observations far transition zone enter via uniform component, distort estimates transition point.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"robust-to-imbalance","dir":"","previous_headings":"","what":"Robust to imbalance","title":"Models for Estimating Stage-Transition Points","text":"inference depends shape densities—counts— unbalanced datasets bias m50.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"bayesian-inference","dir":"","previous_headings":"","what":"Bayesian inference","title":"Models for Estimating Stage-Transition Points","text":"Posterior uncertainty natural, multi-population structure handled hierarchical model. STAGE likelihood structured mixture inspired plateau–Gaussian formulation Lau & Krumscheid (2022), adapted transition-point estimation.","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"package-features","dir":"","previous_headings":"","what":"Package features","title":"Models for Estimating Stage-Transition Points","text":"fit_stage() — fit STAGE model (single multi-population) transition_point() — summarise posteriors m50 predict.stage_fit() — predict class probabilities labels stage_priors() — prior helper get_cmdstan_model() — internal CmdStan compiler helper Planned additions: Reparameterised logistic/HOF model Bayesian LDA Posterior predictive classification Diagnostic + visualisation tools Full vignette","code":""},{"path":"https://anhsmith.github.io/stage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Models for Estimating Stage-Transition Points","text":"need cmdstanr + CmdStan installed: install GitHub:","code":"install.packages(\"cmdstanr\",   repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")) ) cmdstanr::install_cmdstan()   # run once devtools::install_github(\"anhsmith/stage\")"},{"path":"https://anhsmith.github.io/stage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Models for Estimating Stage-Transition Points","text":"Estimated transition point: Prediction:","code":"library(stage)  set.seed(123)  N <- 200 L <- 1000 U <- 1500 true_m50 <- 1250 true_d   <- 100  # simulate data x <- runif(N, L, U) p <- plogis((x - true_m50) / (true_d / 4)) y <- rbinom(N, 1, p)  # fit STAGE model fit <- fit_stage(x, y, L = L, U = U, chains = 2, iter = 1000) fit transition_point(fit) x_grid <- seq(L, U, length.out = 100) p_hat <- predict(fit, x_grid, type = \"prob\")  plot(x_grid, p_hat, type = \"l\",      xlab = \"x\", ylab = \"P(mature)\", las = 1)"},{"path":"https://anhsmith.github.io/stage/index.html","id":"hierarchical-model","dir":"","previous_headings":"","what":"Hierarchical model","title":"Models for Estimating Stage-Transition Points","text":"Multiple populations: returns: global m50 group-specific m50_pop[j]","code":"group <- rep(c(\"A\",\"B\"), each = N/2)  fit2 <- fit_stage(x, y, group = group, L = L, U = U)  transition_point(fit2)"},{"path":"https://anhsmith.github.io/stage/index.html","id":"model-summary","dir":"","previous_headings":"","what":"Model summary","title":"Models for Estimating Stage-Transition Points","text":"class uniform plateau Gaussian edge. Key parameters: m50 — transition centre d — width transition region sigma_x — Gaussian spread Hierarchical structure: (non-centred parameterisation efficient sampling)","code":"m50_pop[j] = mu_m50 + z[j] * sigma_alpha"},{"path":"https://anhsmith.github.io/stage/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"Models for Estimating Stage-Transition Points","text":"","code":"devtools::test() devtools::document() devtools::build_readme()"},{"path":"https://anhsmith.github.io/stage/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Models for Estimating Stage-Transition Points","text":"MIT © Adam N. H. Smith","code":""},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit the STAGE (uniform + Gaussian) generative model — fit_stage","title":"Fit the STAGE (uniform + Gaussian) generative model — fit_stage","text":"Fit STAGE (uniform + Gaussian) generative model","code":""},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit the STAGE (uniform + Gaussian) generative model — fit_stage","text":"","code":"fit_stage(   x,   y,   group = NULL,   L = NULL,   U = NULL,   priors = stage_priors(x, y),   chains = 4,   iter = 2000,   ... )"},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit the STAGE (uniform + Gaussian) generative model — fit_stage","text":"x Numeric vector predictor values (e.g. length). y Binary vector: 0 = immature, 1 = mature. group Optional grouping variable (population). NULL, data treated one population (J = 1). L, U Truncation bounds x. NULL, use min(x) max(x). priors list prior hyperparameters created stage_priors(). chains, iter, ... Passed cmdstanr::sample().","code":""},{"path":"https://anhsmith.github.io/stage/reference/fit_stage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit the STAGE (uniform + Gaussian) generative model — fit_stage","text":"object class \"stage_fit\".","code":""},{"path":"https://anhsmith.github.io/stage/reference/get_cmdstan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Get compiled cmdstanr model — get_cmdstan_model","title":"Get compiled cmdstanr model — get_cmdstan_model","text":"Get compiled cmdstanr model Get compiled cmdstanr model inst/stan","code":""},{"path":"https://anhsmith.github.io/stage/reference/get_cmdstan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get compiled cmdstanr model — get_cmdstan_model","text":"","code":"get_cmdstan_model(stan_file)  get_cmdstan_model(stan_file)"},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict class probabilities from a STAGE model — predict.stage_fit","title":"Predict class probabilities from a STAGE model — predict.stage_fit","text":"Predict class probabilities STAGE model","code":""},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict class probabilities from a STAGE model — predict.stage_fit","text":"","code":"# S3 method for class 'stage_fit' predict(object, newdata, group = NULL, type = c(\"prob\", \"class\"), ...)"},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict class probabilities from a STAGE model — predict.stage_fit","text":"object stage_fit object returned fit_stage(). newdata Numeric vector new x values. group Optional group new x (length 1 length(newdata)). NULL multiple populations model, population 1 used predictions. type \"prob\" P(y = 1 | x), \"class\" 0/1 classification. ... Currently ignored.","code":""},{"path":"https://anhsmith.github.io/stage/reference/predict.stage_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict class probabilities from a STAGE model — predict.stage_fit","text":"Numeric vector probabilities classes.","code":""},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct prior hyperparameters for the STAGE model — stage_priors","title":"Construct prior hyperparameters for the STAGE model — stage_priors","text":"Construct prior hyperparameters STAGE model","code":""},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct prior hyperparameters for the STAGE model — stage_priors","text":"","code":"stage_priors(   x = NULL,   y = NULL,   prior_mu_m50_mu = if (!is.null(x)) stats::median(x) else 0,   prior_mu_m50_tau = if (!is.null(x)) diff(range(x))/6 else 100,   prior_d_mu = if (!is.null(x)) diff(range(x))/4 else 0,   prior_d_tau = if (!is.null(x)) diff(range(x))/4 else 100,   prior_sigma_x_tau = if (!is.null(x)) stats::sd(x) else 100,   prior_sigma_alpha_tau = if (!is.null(x)) diff(range(x))/6 else 100 )"},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct prior hyperparameters for the STAGE model — stage_priors","text":"x, y Optional data vectors set sensible defaults. prior_mu_m50_mu Mean prior global m50. prior_mu_m50_tau SD prior global m50. prior_d_mu Mean prior d. prior_d_tau SD prior d. prior_sigma_x_tau SD scale sigma_x. prior_sigma_alpha_tau SD scale sigma_alpha (-pop).","code":""},{"path":"https://anhsmith.github.io/stage/reference/stage_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct prior hyperparameters for the STAGE model — stage_priors","text":"list elements matching Stan data block.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic transition point extractor — transition_point","title":"Generic transition point extractor — transition_point","text":"Generic transition point extractor","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic transition point extractor — transition_point","text":"","code":"transition_point(object, ...)"},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic transition point extractor — transition_point","text":"object model fit object. ... arguments passed methods.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic transition point extractor — transition_point","text":"Typically numeric vector list summarising transition point.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior summaries of STAGE transition points (m50) — transition_point.stage_fit","title":"Posterior summaries of STAGE transition points (m50) — transition_point.stage_fit","text":"Posterior summaries STAGE transition points (m50)","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior summaries of STAGE transition points (m50) — transition_point.stage_fit","text":"","code":"# S3 method for class 'stage_fit' transition_point(object, population = NULL, ...)"},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior summaries of STAGE transition points (m50) — transition_point.stage_fit","text":"object stage_fit object returned fit_stage(). population Optional population index (integer) label (character). NULL, return global populations. ... Currently ignored. Included method compatibility.","code":""},{"path":"https://anhsmith.github.io/stage/reference/transition_point.stage_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior summaries of STAGE transition points (m50) — transition_point.stage_fit","text":"named list numeric vector posterior summary stats.","code":""}]
