---
title: "Why STAGE?"
output: rmarkdown::html_vignette
bibliography: ../inst/references/ref.bib
vignette: >
  %\VignetteIndexEntry{Why STAGE?}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
library(stage)
set.seed(1)
```


# Introduction

## Problems with existing methods

Estimating a transition point—such as the length at which individuals shift from immature to mature—is a simple and common task. However, the statistical methods typically applied to this task are based on inappropriate assumptions and likely produce biased estimates of transition points.

Below, we discuss three current approaches, highlighting the limitations of each. 

### Ad hoc midpoint methods

A common approach is to avoid fitting a model altogether and instead compute a transition point directly from the data. 
One such method is to take the midpoint between the smallest mature and largest immature individuals. 
The advantage of this approach is that it focuses on the transition zone only. 
However, this approach (1) has no probabilistic foundation and so cannot quantify uncertainty, and 
(2) uses only two data points, so has high variance.

### Discriminative models (e.g., logistic regression) 

Discriminative models such as logistic regression estimate the conditional probability 
$P(y = 1 \mid x)$ _directly_. 
In other words, the model focuses on predicting class labels based on the 
prevalence of one class vs another at each value of $x$. 

While simple and familiar, *logistic regression (and other discriminative models) are highly sensitive to class imbalance*. 
The discriminative model estimates the probability of class in the sample, not the population. 

Unless sampling is independent of both class and size, the estimated curve can be seriously biased. 
If one class has a much greater sample size than the other (i.e., they are unbalanced), 
logistic regression effectively places more weight on the more abundant class. 
This pulls the estimated transition curve toward the majority class, 
even though class counts should not determine where the transition occurs.

An advantage of the discriminative-model approach (over other methods) is that 
inferences about the transition point are based mainly on data near the transition zone.

### Generative models (e.g., Linear Discriminant Analysis)

Generative models (often called generative classifiers) are an alternative approach to discriminative models. 
They model the class-conditional densities  

$f(x \mid y = 0), \qquad f(x \mid y = 1)$, 

and then obtain $P(y=1 \mid x)$ _via_ Bayes’ rule.

The generative classifier approach has the advantage of being less sensitive to 
class imbalance, since the transition point estimate depends on the shapes of 
the class distributions, not their relative sample sizes.
This is achieved by fitting a density to each class separately, 
and then calculating the transition point based on the relative densities of 
the two classes. Linear Discriminant Analysis (LDA) is a widely used generative 
classifier that fits a Gaussian (Normal) density to each class.

This approach is less sensitive to class imbalance, they can suffer from another important limitation: 
*estimates of transition points from LDA (and other generative models) are potentially influenced by all values of $x$, not just those near the transition zone*. 

Observations far from the transition zone greatly affect the fitted density 
for that class, and therefore have undue influence on the estimate of the 
transition point. 
For example, if the true transition is around 1000 mm, individuals at 200–400 mm 
should not influence the estimate of the maturity transition.

In LDA, the Gaussian tail behaviour near the transition is determined by the 
estimated mean and variance of each class—and those estimates are strongly 
affected by observations far from the transition. In the context of length-at-maturity, 
this means that very small immature individuals (e.g., neonates) and very large 
mature individuals have as much influence on the transition point as individuals 
whose lengths fall near the maturity boundary. This is unappealing, because these 
distant observations contain almost no information about the location of the 
transition, yet they shape the Gaussian fits and can shift the inferred transition 
point substantially. This creates a further structural problem: the two tails 
that actually matter for the transition—the upper tail of the immature class 
and the lower tail of the mature class—are not modelled directly against each other. 
Instead, each tail is constrained to be the mirror image of the opposite tail 
of its own class (because of the global Gaussian assumption).

---

## Summary 

What is needed is a model for estimating transition points that:

- is probabilistic and can quantify uncertainty,
- robust to class imbalance, and
- focuses inference on data in the overlap region rather than distant data.

---

# The STAGE solution

The STAGE model is a Bayesian generative classifier where each class is fit with an **asymmetric Uniform–Gaussian mixture**.

- **Immature (y = 0):**  
  uniform plateau → Gaussian decay approaching the transition.
- **Mature (y = 1):**  
  Gaussian rise out of the transition → uniform plateau.

This design has several key consequences:

### Generative modelling  
Transition probability arises from comparing **relative densities**  
(Bayes rule), not from discriminative regression.

### Irrelevant regions contribute minimally  
Observations far from the transition zone enter via the **uniform** component,  
so they cannot distort estimates of the transition point.

### Robust to imbalance  
Because inference depends on the **shape** of the densities—not the counts—  
unbalanced datasets do not bias m50.

### Bayesian inference  
Posterior uncertainty is natural, and multi-population structure is  
handled with a hierarchical model.

The STAGE likelihood is a structured mixture inspired by the plateau–Gaussian  
formulation of Lau & Krumscheid [-@lau_plateau_2022], 
adapted for transition-point estimation.

# References
